# Load data
SANM <- read.csv(file = "SANM.csv")
library(ggplot2)
ggplot(data = SANM, mapping = aes(x = Date, y = Close)) + geom_point() + geom_line() + geom_smooth(method = "lm")
ggplot(data = SANM, mapping = aes(x = Date, y = Close)) + geom_point() + geom_line() + geom_smooth(mapping = aes(x = Date, y = Close),method = "lm")
ggplot(data = SANM, mapping = aes(x = Date, y = Close)) + geom_point()  + geom_smooth(mapping = aes(x = Date, y = Close),method = "lm")
ggplot(data = SANM, mapping = aes(x = Date, y = Close)) + geom_point()  + geom_smooth(mapping = aes(x = Date, y = Close),method = "loess")
SANM$Date <- as.Date(SANM$Date)
ggplot(data = SANM, mapping = aes(x = Date, y = Close)) + geom_point()  + geom_smooth(mapping = aes(x = Date, y = Close),method = "loess")
ggplot(data = SANM, mapping = aes(x = Date, y = Close)) + geom_point()  + geom_smooth(mapping = aes(x = Date, y = Close),method = "lm")
ggplot(data = SANM, mapping = aes(x = Date, y = Close)) + geom_point()  + geom_smooth(mapping = aes(x = Date, y = Close),method = "loess")
HoltWinters(SANM$Close)
closing <- ts(data = SANM$Close,start = 1, end = nrow(SANM),frequency = 2)
forecasts <- HoltWinters(closing)
forecasts$fitted
forecasts <- HoltWinters(closing)
plot(forecasts)
closing <- ts(data = SANM$Close,start = 1, end = nrow(SANM),frequency = 1)
forecasts <- HoltWinters(closing)
View(SANM)
plot(SANM$Date)
loess(Close ~ Date, SANM)
loess(Close ~ Date, data = SANM)
loess(formula = Close ~ Date , data = SANM)
loess(formula = Date ~ Close , data = SANM)
loess(formula = Close ~ Date , data = SANM, span = 1)
View(SANM)
skimr::skim(SANM)
loess(formula = Close ~ Date , data = SANM, degree = 1)
loess(formula = Close ~ Date , data = SANM, degree = 1,parametric = T)
loess(formula = Close ~ Date , data = SANM, degree = 1,parametric = F)
loess(formula = Close ~ Date , data = SANM, sapn  =.1)
install.packages("forecast")
forecast::is.splineforecast(SANM$Close)
as.POSIXct(SANM$Date)
as.Date.numeric(SANM$Date)
as.Date.numeric(SANM$Date,origin = "1900-01-01")
as.Date.numeric(SANM$Date,origin = as.Date("1900-01-01"))
as.numeric(SANM$Date)
SANM$Datenum <- as.numeric(SANM$Date)
loess(Close ~ Datenum, data = SANM)
loess.mdl <- loess(Close ~ Datenum, data = SANM)
View(SANM)
predict(loess.mdl,newdata = c(17624))
predict(loess.mdl,newdata = 17624)
predict(loess.mdl,newdata = data.frame(Date =17624))
predict(loess.mdl,newdata = data.frame(Datenum =17624))
predict(loess.mdl,newdata = data.frame(Datenum = c(17624,17626))
)
predict(loess.mdl,newdata = data.frame(Datenum = c(17624,17626)))
loess.mdl <- loess(Close ~ Datenum, data = SANM)
predict(loess.mdl,newdata = data.frame(Datenum = c(17624,17626)))
predict(loess.mdl,newdata = data.frame(Datenum = c(17599)))
predict(loess.mdl,newdata = data.frame(Datenum = c(17624)))
predict(loess.mdl,newdata = data.frame(Datenum = c(17623)))
loess.mdl <- loess(Close ~ Datenum, data = SANM,control = loess.control(surface = "direct"))
predict(loess.mdl,newdata = data.frame(Datenum = c(17599)))
predict(loess.mdl,newdata = data.frame(Datenum = c(17624)))
Newdata = data.frame(Datenum = seq(17624,by = 1,length.out = 30))
predicted <- predict(loess.mdl,newdata = Newdata)
Newdata$Close <- predicted
Stocks <- SANM %>% dplyr::select(Date,Close)
# Load data
library(magrittr)
Stocks <- SANM %>% dplyr::select(Date,Close)
Stocks <- rbind.data.frame(Stocks, Newdata)
Stocks <- SANM %>% dplyr::select(Datenum,Close)
Stocks <- rbind.data.frame(Stocks, Newdata)
Stocks <- Stocks %>% dplyr::mutate(Date = as.Date(Datenum))
Stocks <- Stocks %>% dplyr::mutate(Date = as.Date.dates(Datenum))
as.Date(17599)
lubridate::as_date(17599)
Stocks <- Stocks %>% dplyr::mutate(Date = lubridate::as_date(Date))
Stocks <- Stocks %>% dplyr::mutate(Date = lubridate::as_date(Datenum))
Stocks <- Stocks %>% dplyr::mutate(Predicted = c(rep("Actual",503),rep("Predicted",30)))
ggplot(data = Stocks, mapping = aes(x = Date, y = Close, color = Predicted)) + geom_point() + geom_smooth(method = "loess")
ggplot(data = Stocks, mapping = aes(x = Date, y = Close, color = Predicted)) + geom_point() + geom_smooth(method = "loess") + ggtitle("Stock price of SANMINA CORP (SANM)")
knitr::opts_chunk$set(echo = TRUE)
library(forecast)
data(ausbeer)
data(ausbeer)
install.packages("fpp")
library(fpp)
data(ausbeer)
head(ausbeer)
View(ausbeer)
ausbeer
class(ausbeer)
example(ts)
ts(1:10, frequency = 4, start = c(1959, 3))
ts(1:10, frequency = 4, start = c(1959, 2))
example(ts)
ts(matrix(rnorm(300), 100, 3), start = c(1961, 1), frequency = 10)
ts(matrix(rnorm(300), 100, 3), start = c(1961, 1), frequency = 12)
ts(matrix(rnorm(300), 100, 3), start = c(1961, 1), frequency = 4)
ts(matrix(rnorm(300), 100, 3), start = c(1961, 1), frequency = 6)
knitr::opts_chunk$set(echo = TRUE)
library(magrittr)
library(ggplot2)
library(dplyr)
# Read data in
SANM <- read.csv(file = "SANM.csv")
plot(SANM$Adj.Close)
y <- 2 + 3*(seq(5:10))
plot(y)
x <- 2 + 3*(seq(1:10))
t=seq(0,10,0.1)
y <-  x + sin(t)
t=seq(0,10,1)
y <-  x + sin(t)
plot(y)
x <- 2 + 3*(seq(1:100))
t=seq(0,10,.1)
y <-  x + sin(t)
plot(y)
swm <- read.csv("swm.csv", header = F)
View(swm)
ggplot(data = swm, mapping = aes(y = V1)) + geom_line()
swm$ID <- seq(1:nrow(swm))
ggplot(data=swm, maping = aes(x = ID, y = V1)) + geom_line() + geom_smooth()
ggplot(data=swm, maping = aes(x = ID, y = V1)) + geom_line() + geom_smooth(aes(x = ID, y = V1))
ggplot(data=swm, maping = aes(x = ID, y = V1)) + geom_line()
ggplot(data=swm, maping = aes(x = ID, y = V1)) + geom_line()
ggplot(data=swm, maping = aes(x = ID, y = V1))
ggplot(data=swm, maping = aes(x = ID, y = V1)) + geom_point()
ggplot(data = swm, maping = aes(x = ID, y = V1)) + geom_point()
plot(swm)
plot(swm$V1)
swm <- ts(data = swm$V1, start = 2015)
swm
swm <- ts(data = swm$V1, start = 2015, frequency = 12)
swm <- read.csv("swm.csv", header = F)
swm <- ts(data = swm$V1, start = 2015, frequency = 12)
swm
rawdata<- read.csv("swm.csv", header = F)
View(rawdata)
ggplot(data = rawdata, aes(y = V1))
ggplot(data = rawdata, aes(y = V1)) + geom_point()
rawdata$ID <- seq(1:nrow(swm))
rawdata$ID <- seq(1:nrow(rawdata))
ggplot(data = rawdata, aes(y = V1, x = ID)) + geom_point()
ggplot(data = rawdata, aes(y = V1, x = ID)) + geom_point() + geom_smooth()
forecast::holt(swm,h=5)
plot(forecast::holt(swm,h=5))
holts <- forecast::holt(swm,h=5)
plot(swm)
plot(swm)
lines(holts)
head(holts)
plot(swm)
line(holts$fitted)
holts$fitted
plot(swm)
line(x = rawdata$ID, holts$fitted)
line(x = rawdata$ID, holts$fitted, col = "red")
plot(swm)
line(x = rawdata$ID, holts$fitted, col = "red")
predicted$ID <- seq(1:nrow(rawdata))
predicted$Vals <- holts$fitted
rm(predicted)
predicted$ID <- seq(1:nrow(rawdata))
predicted <- data_frame()
predicted$ID <- seq(1:nrow(rawdata))
predicted$V1 <- holts$fitted
rm(predicted)
predicted$V1 <- holts$fitted
predicted <- data.frame(V1 = holts$fitted, ID = rawdata$ID)
rawdata.copy <- rbind.data.frame(rawdata,predicted)
View(rawdata.copy)
rawdata.copy$Category <- c(rep("Actual", 36), rep("predicted", 36))
ggplot(data = rawdata.copy, mapping = aes(x = ID, y = V1, col = Category)) + geom_point()
holts <- forecast::holt(swm[-12],h=5)
predicted <- data.frame(V1 = holts$fitted, ID = rawdata$ID[-12])
rawdata.copy <- rbind.data.frame(rawdata,predicted)
rawdata.copy$Category <- c(rep("Actual", 36), rep("predicted", 36))
rawdata.copy$Category <- c(rep("Actual", 35), rep("predicted", 35))
holts <- forecast::holt(swm[-12],h=5)
predicted <- data.frame(V1 = holts$fitted, ID = rawdata$ID[-12])
rawdata.copy <- rbind.data.frame(rawdata[-12,],predicted)
rawdata.copy$Category <- c(rep("Actual", 35), rep("predicted", 35))
ggplot(data = rawdata.copy, mapping = aes(x = ID, y = V1, col = Category)) + geom_point()
hist(holts$residuals)
ggplot(data = rawdata.copy, mapping = aes(x = ID, y = V1, col = Category)) + geom_point()
plot(swn)
plot(swm)
ggplot(data = rawdata.copy, mapping = aes(x = ID, y = V1, col = Category)) + geom_point()
hist(holts$residuals)
rawdata<- read.csv("swm.csv", header = F)
rawdata<- read.csv("swm.csv", header = F)
rawdata$ID <- seq(1:nrow(rawdata))
swm <- ts(data = swm$V1, start = 2015, frequency = 12)
rawdata<- read.csv("swm.csv", header = F)
rawdata$ID <- seq(1:nrow(rawdata))
swm <- ts(data = rawdata$V1, start = 2015, frequency = 12)
plot(swm)
ggplot(data = rawdata, aes(y = V1, x = ID)) + geom_point() + geom_smooth()
holts <- forecast::holt(swm[-12],h=5,)
predicted <- data.frame(V1 = holts$fitted, ID = rawdata$ID[-12])
rawdata.copy <- rbind.data.frame(rawdata[-12,],predicted)
rawdata.copy$Category <- c(rep("Actual", 35), rep("predicted", 35))
ggplot(data = rawdata.copy, mapping = aes(x = ID, y = V1, col = Category)) + geom_point()
hist(holts$residuals)
hw <- forecast::
knitr::opts_chunk$set(echo = TRUE)
SANM <- read.csv(file = "SANM.csv")
SANM  %<>% dplyr::mutate(Date = as.date(Date)) %>%
dplyr::mutate(Datenum = as.numeric(Date))
SANM  %<>% dplyr::mutate(Date = as.Date(Date)) %>%
dplyr::mutate(Datenum = as.numeric(Date))
ggplot(data = SANM, mapping = aes(x = Date, y = Close)) + geom_point()  + geom_smooth(mapping = aes(x = Date, y = Close),method = "loess")
ggplot(data = SANM, mapping = aes(x = Date, y = Close)) + geom_point()  + geom_smooth(mapping = aes(x = Date, y = Close),method = "lm")
